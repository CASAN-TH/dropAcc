<div class="page-layout blank p-24" fusePerfectScrollbar>
  <div fxLayout="row" fxFlex="100" *ngIf="records.length > 0; else noData">
    <div class="widget" fxFlex="100" fxFlex.gt-sm="30">
      <div class="fuse-card">
        <div class="light-blue-600">
          <div class="p-16" fxLayout="row" fxLayoutAlign="space-between center">
            <div class="pr-16">
              <div class="h1 font-weight-300">
                {{ fileDescription.sourceType }}
              </div>
              <div class="h5 secondary-text">
                {{ fileDescription.fileInfo.name }}
              </div>
            </div>
          </div>

          <div class="p-16 pt-8" fxLayout="row" fxLayoutAlign="center end">
            <div fxLayout="row" fxFlex="70" fxLayoutAlign="center end">
              <button
                class="mat-primary mat-raised-button"
                (click)="confirmImportClick()"
              >
                ยืนยัน การนำเข้าข้อมูล
              </button>
            </div>
            <div fxLayout="row" fxFlex="30" fxLayoutAlign="center end">
              <button
                class="mat-warn mat-raised-button pl-5"
                (click)="cancelImportClick()"
              >
                ลองใหม่
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div fxFlex="100" fxFlex.gt-sm="70" fxLayoutAlign="space-between start">
      <ngx-datatable
        fxFlex="95"
        class="material fullscreen pl-5"
        [rows]="records"
        [limit]="10"
        [columnMode]="'force'"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="50"
        scrollbarH="true"
        [sorts]="[{ prop: 'customerName' }]"
      >
        <ngx-datatable-column name="No.">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.no }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Status">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.status }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Customer Name">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.customerName }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Customer Phone">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.customerPhone }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Item Name">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.itemName }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Item Qty">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.itemQty | number }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Item Price">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.itemPrice | number }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Item Subtotal">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row.itemSubtotal | number }}
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>
  </div>
</div>
<ng-template #noData>
  <div
    class="fuse-card simple clickable dropzone"
    fxLayout="column"
    fxLayoutAlign="center center"
    fxFlex="100"
    (drop)="drop($event)"
    (dragover)="allowDrop($event)"
  >
    <label fxLayout="column" for="file-input">
      <p fxLayoutAlign="center center">
        <mat-icon fxLayoutAlign="center center">backup</mat-icon>
      </p>
      <p fxLayoutAlign="center end">
        คุณสามารถลากและปล่อยไฟล์ Excel ในนี้เพื่ออัพโหลด
      </p>
      <p fxLayoutAlign="center end">
        หรือ คลิ๊กเพื่อเลือกไฟล์ Excel จากไดเรกทอรีของท่าน
      </p>
      <input
        name="detectFiles"
        id="file-input"
        type="file"
        (change)="detectFiles($event)"
        accept=".csv,.xls,.xlsx"
      />
    </label>
  </div>
</ng-template>
